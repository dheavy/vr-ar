<!DOCTYPE html>
<html>
  <head>
    <title>VR / AR</title>
    <style type="text/css">
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }

      .content {
        position: absolute;
        width: 100%;
        height: auto;
      }
    </style>
  </head>

  <body>
    <video autoplay class="content"></video>

    <script type="text/javascript">
      'use strict';

      function getSource() {
        if (!navigator.mediaDevices) return null;

        return navigator.mediaDevices.enumerateDevices()
          .then(function (devices) {
            var cameras = devices.filter(function (source) {
              return source.kind === 'videoinput'
            });

            var backCam = cameras.filter(function (cam) {
              return cam.label.indexOf('back') > -1;
            });

            return Promise.resolve(backCam.length > 0 ? backCam[0] : cameras[0]);
          });
      }

      function getUserMedia(options, success, failure) {
        var api = navigator.getUserMedia ||
                  navigator.webkitGetUserMedia ||
                  navigator.mozGetUserMedia ||
                  navigator.msGetUserMedia;

        if (api) {
          return api.bind(navigator)(options, success, failure);
        }
      }

      function getStream(source) {
        var constraints = {};

        constraints.video = {
          optional: [{sourceId: source.deviceId}]
        };

        getUserMedia(constraints, function(stream) {
          var mediaControl = document.querySelector('video');
          if (navigator.mozGetUserMedia) {
            mediaControl.mozSrcObject = stream;
          } else {
            mediaControl.srcObject = stream;
            mediaControl.src = (window.URL ||Â window.webkitURL).createObjectURL(stream);
          }
        }, function (err) {
          alert('Error: ' + err);
        });
      }

      window.onload = function () {
        getSource().then(function (cam) {
          getStream(cam);
        });
      };
    </script>
  </body>
</html>
